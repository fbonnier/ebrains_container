# ====== Model-Runner ======= #
FROM python:2.7 AS model-runner


ENV TZ=Europe/Kiev

EXPOSE 667

# Set default shell
SHELL ["/bin/bash", "-c"]

# Set timezone
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone

# Update system and install requirements
# COPY apt_requirements_deb06648-aa05-4f67-9311-e4fb3c62149d.txt apt_requirements.txt
# RUN apt-get -y update && apt-get -y upgrade;
# RUN xargs apt-get -y install --no-install-recommends < apt_requirements.txt
# RUN apt-get autoremove -y && \
#     rm -rf /var/lib/apt/lists/* 

# Install NEURON
RUN pip install bluepyopt

# Simulate Spack Env Activate
ENV PATH="/usr/src/app:$PATH"

# Set Python Virtual Environment
# COPY requirements_deb06648-aa05-4f67-9311-e4fb3c62149d.txt requirements.txt
# RUN pip install --no-cache-dir --upgrade pip setuptools wheel mock importlib_metadata packaging ordered-set more_itertools jaraco.text importlib_resources tomli platformdirs
# RUN pip install --no-cache-dir -r requirements.txt

# Copy model
RUN wget https://data-proxy.ebrains.eu/api/v1/buckets/pc0a33-sp6_usecase_resources/models/basalunit/msn_d2_all-5-20170517.tar.gz
